{% extends "base.html" %}
{% block title %}Mis Reservas{% endblock %}
{% block content %}

<section class="py-16 sm:py-24">
  <div class="container mx-auto px-6 max-w-3xl">
    <h2 class="text-3xl font-bold mb-6 text-gray-900 dark:text-white">Mis reservas</h2>

    {% if reservas %}
    <ul class="space-y-4">
      {% for reserva in reservas %}
      <li class="bg-white dark:bg-gray-900 p-4 rounded-lg shadow">
        <p><strong>Habitación:</strong> {{ reserva.habitacion.nombre }} ({{ reserva.habitacion.numero }})</p>
        <p><strong>Fechas:</strong> {{ reserva.fecha_entrada }} a {{ reserva.fecha_salida }}</p>
        <p><strong>Estado:</strong> {{ reserva.estado }}</p>

        {% if reserva.estado != 'cancelada' %}
        <button class="text-red-600 hover:underline" data-url="{{ url_for('cancelar_reserva', reserva_id=reserva.id) }}"
          onclick="mostrarModal(this.dataset.url)">
          Cancelar reserva
        </button>
        {% endif %}
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <p class="text-gray-600 dark:text-gray-400">No tienes reservas registradas.</p>
    {% endif %}
  </div>
</section>

<!-- Modal -->
<div id="modal-confirmacion" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-sm w-full">
    <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">¿Cancelar esta reserva?</h3>
    <p class="text-gray-700 dark:text-gray-300 mb-6">Esta acción no se puede deshacer.</p>
    <div class="flex justify-end space-x-4">
      <button onclick="cerrarModal()"
        class="px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-gray-400 dark:hover:bg-gray-600">
        No, volver
      </button>
      <a id="confirmar-cancelacion" href="#" class="px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700">
        Sí, cancelar
      </a>
    </div>
  </div>
</div>

<script>
  function mostrarModal(url) {
    document.getElementById('modal-confirmacion').classList.remove('hidden');
    document.getElementById('confirmar-cancelacion').setAttribute('href', url);
  }

  function cerrarModal() {
    document.getElementById('modal-confirmacion').classList.add('hidden');
  }
</script>

{% endblock %}